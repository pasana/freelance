columns = [
    "date",
    "time",
    "league",
    "match",
    "1",
    "X",
    "2",
    "1X",
    "X2",
    "12",
    "PP 1",
    "PP X",
    "PP 2",
    "DP 1",
    "DP X",
    "DP 2",
    "0-1 goals",
    "0-2 goals",
    "0-3 goals",
    "0-4 goals",
    "0-5 goals",
    "2+ goals",
    "3+ goals",
    "4+ goals",
    "5+ goals",
    "6+ goals",
    "7+ goals",
    "1-2 goals",
    "1-3 goals",
    "1-4 goals",
    "1-5 goals",
    "1-6 goals",
    "2-3 goals",
    "2-4 goals",
    "2-5 goals",
    "2-6 goals",
    "3-4 goals",
    "3-5 goals",
    "3-6 goals",
    "4-5 goals",
    "4-6 goals",
    "PP 0 goals",
    "PP 1+ goals",
    "PP 0-1 goals",
    "PP 2+ goals",
    "PP 3+ goals",
    "PP 1-2 goals",
    "PP 2-3 goals",
    "DP 0 goals",
    "DP 1+ goals",
    "DP 0-1 goals",
    "DP 2+ goals",
    "DP 3+ goals",
    "DP 1-2 goals",
    "DP 2-3 goals",
    "1+PP&1+DP",
    "2+PP&2+DP",
    "0-2PP&0-2DP",
    "2+PP V 2+DP",
    "3+PP V 3+DP",
    "GG",
    "NG",
    "PP GG",
    "DP GG",
    "PP NG",
    "DP NG",
    "PPGGvDPGG",
    "PPGG&DPGG",
    "Obatima 2+",
    "GG 3+",
    "NE GG 3+",
    "GG 4+",
    "NE GG 4+",
    "1&GG",
    "2&GG",
    "Sigurna pobeda 1",
    "Sigurna pobeda 1 NE",
    "Sigurna pobeda 2",
    "Sigurna pobeda 2 NE",
    "Dupla pobeda 1",
    "Dupla pobeda 1 NE",
    "Dupla pobeda 2",
    "Dupla pobeda 2 NE",
    "Team 1 1+ goals",
    "Team 1 0 goals",
    "Team 1 2+ goals",
    "Team 1 0-1 goals",
    "Team 1 3+ goals",
    "Team 1 2-3 goals",
    "Team 1 1-2 goals",
    "Team 1 1-3 goals",
    "Team 2 0 goals",
    "Team 2 1+ goals",
    "Team 2 2+ goals",
    "Team 2 3+ goals",
    "Team 2 0-1 goals",
    "Team 2 2-3 goals",
    "Team 2 1-2 goals",
    "Team 2 1-3 goals",
    "DOM PP 1+ goals",
    "DOM PP 0 goals",
    "DOM PP 0-1 goals",
    "DOM PP 2+ goals",
    "DOM PP 1-2 goals",
    "DOM DP 1+ goals",
    "DOM DP 0 goals",
    "DOM DP 0-1 goals",
    "DOM DP 2+ goals",
    "DOM DP 1-2 goals",
    "DOM 1+&1+",
    "NE DOM 1+&1+",
    "GOST 1+&1+",
    "NE GOST 1+&1+",
    "GOST PP 1+ goals",
    "GOST PP 0 goals",
    "GOST PP 0-1 goals",
    "GOST PP 2+ goals",
    "GOST PP 1-2 goals",
    "GOST DP 1+ goals",
    "GOST DP 0 goals",
    "GOST DP 0-1 goals",
    "GOST DP 2+ goals",
    "GOST DP 1-2 goals",
    "1 & 2+",
    "NE 1 & 2+",
    "1 & 3+",
    "NE 1 & 3+",
    "1 & 4+",
    "NE 1 & 4+",
    "1 & 5+",
    "1 & 0-2",
    "NE 1 & 0-2",
    "2 & 2+",
    "NE 2 & 2+",
    "2 & 3+",
    "NE 2 & 3+",
    "2 & 4+",
    "NE 2 & 4+",
    "2 & 5+",
    "2 & 0-2",
    "NE 2 & 0-2",
    "1X & 3+",
    "NE 1X & 3+",
    "1X & 4+",
    "NE 1X & 4+",
    "1X & 0-2",
    "NE 1X & 0-2",
    "1X & 0-3",
    "NE 1X & 0-3",
    "1X & 2-3",
    "NE 1X & 2-3",
    "1X & GG",
    "NE 1X & GG",
    "X2 & 3+",
    "NE X2 & 3+",
    "X2 & 4+",
    "NE X2 & 4+",
    "X2 & 0-2",
    "NE X2 & 0-2",
    "X2 & 0-3",
    "NE X2 & 0-3",
    "X2 & 2-3",
    "NE X2 & 2-3",
    "X2 & GG",
    "NE X2 & GG",
    "1-1",
    "NE 1-1",
    "1-X",
    "1-2",
    "X-1",
    "NE X-1",
    "X-X",
    "NE X-X",
    "X-2",
    "NE X-2",
    "2-2",
    "NE 2-2",
    "2-X",
    "2-1",
    "DNB 1",
    "DNB 2",
    "1 V 3+",
    "2 V 3+",
    "1 V pp1",
    "X V ppX",
    "2 V pp2",
    "1 H1.5",
    "2 H1.5",
    "1 H2.5",
    "2 H2.5",
    "Tacno 1 goals",
    "Tacno 2 goals",
    "Tacno 3 goals",
    "Tacno 4 goals",
    "Tacno 5 goals",
    "NE Tacno 1 goals",
    "NE Tacno 2 goals",
    "NE Tacno 3 goals",
    "NE Tacno 4 goals",
    "PP Tacno 1 goals",
    "PP Tacno 2 goals",
    "NE PP Tacno 1 goals",
    "NE PP Tacno 2 goals",
    "DP Tacno 1 goals",
    "DP Tacno 2 goals",
    "NE DP Tacno 1 goals",
    "NE DP Tacno 2 goals",
    "PP 0-2 goals",
    "DP 0-2 goals",
    "Team 1 0-2 goals",
    "Team 2 0-2 goals",
    "Team 2 Tacno 1 goals",
    "Team 2 Tacno 2 goals",
    "NE Team 2 Tacno 1 goals",
    "NE Team 2 Tacno 2 goals",
    "Team 1 Tacno 1 goals",
    "Team 1 Tacno 2 goals",
    "NE Team 1 Tacno 1 goals",
    "NE Team 1 Tacno 2 goals",
    "Team 1 Prvi Daje Gol",
    "Team 2 Prvi Daje Gol",
    "Team 2 PP1+&DP1+",
    "NE Team 2 PP1+&DP1+",
    "Team 1 PP1+&DP1+",
    "NE Team 1 PP1+&DP1+",
    "DOM PP 3+ goals",
    "DOM DP 3+ goals",
    "GOST PP 3+ goals",
    "GOST DP 3+ goals",
    "X&GG",
    "NE X&GG",
    "0-1PP&0-1DP",
    "NE 0-1PP&0-1DP",
    "1&NG",
    "X&NG",
    "2&NG",
    "X & 0-2",
    "NE X & 0-2",
    "GG 0-2",
    "NG 0-2",
    "NG 3+",
    "1 & 0-3",
    "2 & 0-3",
    "1X & NG",
    "X2 & NG",
    "12 & NG",
    "12 & GG",
    "1X & 0-1",
    "X2 & 0-1",
    "12 & 0-1",
    "12 & 4+",
    "0-1PP&0-1DP",
    "NE 0-1PP&0-1DP",
    "NE 0-2PP&0-2DP",
    "NE 1+PP&1+DP",
    "NE 2+PP&2+DP",
    "X V 3+",
    "1 V 0-2",
    "X V 0-2",
    "2 V 0-2",
    "1 V GG",
    "X V GG",
    "2 V GG",
    "1 V NG",
    "X V NG",
    "2 V NG",
    "NG&NG",
    "GG&NG",
    "NE GG&NG",
    "NG&GG",
    "NE NG&GG",
    "Team 1 4+ goals",
    "Team 1 0-3 goals",
    "Team 2 4+ goals",
    "Team 2 0-3 goals",
    "DP 1-3 goals",
    "PP 1-3 goals",
    "TR 0-0",
    "DOM 2+PP&2+DP",
    "GOST 2+PP&2+DP",
    "Team 2 Tacno 3 goals",
    "NE Team 2 Tacno 3 goals",
    "Team 1 Tacno 3 goals",
    "NE Team 1 Tacno 3 goals",
    "X & 3+",
    "NE X & 3+",
    "NE 1&GG",
    "NE 2&GG",
    "12 & GG",
    "NE 12 & GG",
    "X & 0-2", 
    "NE X & 0-2",
    "12 & 3+", 
    "NE 12 & 3+", 
    "12 & 0-2",
    "NE 12 & 0-2",
    "0-1PP&0-1PP",
    "NE 0-1PP&0-1PP",
    "NE NG 0-2",
    "NG 0-3",
    "NE NG 0-3",
    "X & GG",
    "NE X & GG",
]

import time, os, datetime, re, sys, traceback
import selenium
import xlsxwriter
from bs4 import BeautifulSoup
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

def store_to_xlsx(data, filename):
    workbook = xlsxwriter.Workbook(filename)
    worksheet = workbook.add_worksheet()
    format = workbook.add_format()
    format = workbook.add_format({'bold': True, 'bg_color': '#800000', 'font_color': 'white'})
    worksheet.add_table(0,0,len(data)+1,len(columns))
    row = 0
    col = 0
    for field in columns:
        worksheet.write(row, col, field, format)
        col += 1
    for match in data:
        row += 1
        col = 0
        for key in columns:
            try:
                worksheet.write(row, col, match[key])
            except:
                worksheet.write(row, col, 1)
            col+=1
        worksheet.write(row, col, '=1/E%d+1/F%d+1/G%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/Q%d+1/V%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/R%d+1/W%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/S%d+1/X%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/T%d+1/Y%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/U%d+1/Z%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/AP%d+1/AQ%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/AR%d+1/AS%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/AT%d+1/AU%d+1/AP%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/AW%d+1/AX%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/AY%d+1/AZ%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BI%d+1/BJ%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BK%d+1/BM%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BL%d+1/BN%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BR%d+1/BS%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BT%d+1/BU%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BX%d+1/BY%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BZ%d+1/CA%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/CB%d+1/CC%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/CD%d+1/CE%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/CF%d+1/CG%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/CH%d+1/CI%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/CN%d+1/CO%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/CR%d+1/CP%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/CV%d+1/CW%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/DT%d+1/DU%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/DV%d+1/DW%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/DX%d+1/DY%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EC%d+1/ED%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EE%d+1/EF%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EG%d+1/EH%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EL%d+1/EM%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EN%d+1/EO%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EP%d+1/EQ%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EX%d+1/EY%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EZ%d+1/FA%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/FB%d+1/FC%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/FJ%d+1/FK%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/FN%d+1/FO%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/FP%d+1/FQ%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/FR%d+1/FS%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/FT%d+1/FU%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/FX%d+1/FY%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/DV%d+1/R%d+1/EX%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EL%d+1/EE%d+1/R%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EA%d+1/FB%d+1/W%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EP%d+1/EJ%d+1/W%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EJ%d+1/EK%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/EA%d+1/EB%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/FB%d+1/FZ%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BG%d+1/HX%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BO%d+1/JG%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JH%d+1/JI%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JJ%d+1/JK%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GI%d+1/GN%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GJ%d+1/GO%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GK%d+1/GP%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GL%d+1/GQ%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BD%d+1/IU%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GR%d+1/GT%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GS%d+1/GU%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GV%d+1/GX%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GW%d+1/GY%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/IR%d+1/BG%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/BF%d+1/BH%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/GA%d+1/EP%d' % (row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/W%d+1/AB%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/X%d+1/AC%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/Y%d+1/AD%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/Z%d+1/AE%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/AA%d+1/AF%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/GJ%d+1/V%d' % (row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/GJ%d+1/X%d+1/AG%d' % (row + 1, row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/GJ%d+1/Y%d+1/AH%d' % (row + 1, row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/GI%d+1/Z%d+1/AI%d' % (row + 1, row + 1, row + 1, row + 1))
        col += 1
        worksheet.write(row, col, '=1/JR%d+1/GJ%d+1/AA%d+1/AJ%d' % (row + 1, row + 1, row + 1, row + 1))
        col += 1
    worksheet.freeze_panes(1, 4)
    workbook.close()


class AbstractScraper:
    website = ''
    pass

class MarathonbetScraper(AbstractScraper):
    website = 'https://www.marathonbet.com/en/betting/11?periodGroupAllEvents=0'
    scraper_name='Marathonbet'
    game_xp='//tbody[@id="event_%d"]'
    button_xp='//tbody[@id="event_%d"]//span[@class="event-more-view"]'
    def __init__(cls):
        pass
    @classmethod
    def scrape(cls):
        try:
            return cls._scrape()
        except:
            print 'Failed scraping from', cls.website
            traceback.print_exc(file=sys.stdout)
            return []
    @classmethod
    def _scrape(cls):
        #start
        chromedriver = "/home/alice/chromedriver"
        #chromedriver = "C:/Users/Marko/Documents/chromedriver"
        os.environ["webdriver.chrome.driver"] = chromedriver
        driver = webdriver.Chrome(chromedriver)
        driver.maximize_window()
        #opening web-page
        driver.get('https://www.marathonbet.com/en/betting/11?periodGroupAllEvents=0')
        menu=driver.find_elements_by_xpath('//div[@class="head-sub-item js-head-sub-item"]')
        for m in menu:
            if m.text == 'Settings':
                menu=m
                break
        menu.click()
        driver.find_elements_by_xpath('//div[@class="ur-link two-line-text"]')[1].click()
        driver.find_element_by_xpath('//div[@data-site-style-value="MULTIMARKETS"]').click()
        #content
        content = driver.find_element_by_id("container_EVENTS")
        soup=BeautifulSoup(content.get_attribute('innerHTML'), "html.parser")
        soup = soup.find('div', {'class':"sport-category-container"})
        soup = soup.find('div', {'class':"sport-category-content"})
        game_ids = []
        games = []
        #getting main info
        for league in soup.contents:
            try:
                league_name = league.find('h2').find('div').getText().strip() #leauge name
                print league_name
                matches = league.find('table').findAll('tbody')
                for match in matches:
                    try:    
                        plus_bet = int(match.find('span',{'class' : 'event-more-view'}).getText().strip())
                        game = {}
                        teams=match.find('span').findAll('div')
                        game['match']=teams[0].getText()+' vs ' + teams[1].getText()
                        #game['match']=match['data-event-name'] #match name
                        game['league']=league_name
                        game['scraper_name']=cls.scraper_name
                        [game['date'], game['time']]=cls.clean_date(match)
                        odds = cls.get_odds(match)
                        game['1']=odds[0]                #1X2 1st Teamp
                        game['X']=odds[1]                #1X2 Draw
                        game['2']=odds[2]                #1X2 2nd Team
                        game['1X']=odds[3]                #1X2 1st Teamp
                        game['12']=odds[4]                #1X2 Draw
                        game['X2']=odds[5]                #1X2 2nd Team
                        check = match.findAll('td')[-2].getText().strip().split('\n')[0]
                        print "check ", check
                        if check == '(2.5)':
                            game['0-2 goals']=odds[8]                #Over/Under under Hide 2.5
                            game['3+ goals']=odds[9]                #Over/Under over Hide 2.5
                        games += [game]
                        if plus_bet > 10:
                            game_ids += [{'treeid': int(match['data-event-treeid']), \
                                          'list_id': len(games)-1}]
                    except:
                        pass
            except:
                pass
        wait=WebDriverWait(driver, 120)
        #extra info
        for id_dict in game_ids:
            i = id_dict['list_id']
            id = id_dict['treeid']
            print i 
            try:
                driver.find_element_by_xpath(cls.button_xp%id).click()
                #wait.until(EC.presence_of_element_located((By.XPATH, cls.button_xp%id))).click()
            except:
                print "game is lost" 
                continue
            #driver.find_element_by_xpath(cls.button_xp%id).click()
            time.sleep(.5)
            game=driver.find_element_by_xpath(cls.game_xp%id)
            soup=BeautifulSoup(game.get_attribute('innerHTML'), "html.parser")
            teams=games[i]['match'].split(' vs ')
            teams = [team.strip() for team in teams]
            types=soup.findAll('div', {'class':'name-field'})
            for bet_type in types:
            #Correct Score
                if bet_type.getText().strip() == 'Correct Score':
                    tr=bet_type.parent.parent.findAll('td')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(0 - 0)':
                                odds = cls.get_odds(t)
                                games[i]['TR 0-0']=odds[0]
                                #print "Correct Score", odds
                        except:
                            pass
                    break
            #To Win To Nil
                if bet_type.getText().strip() == 'Winning Method':
                    str = 'To Win To Nil - %s'
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == str % teams[0]:
                                odds = cls.get_odds(t)
                                games[i]['Sigurna pobeda 1']=odds[0]                #Home Win to Nil Yes
                                try: 
                                    games[i]['Sigurna pobeda 1 NE']=odds[1]        #Home Win to Nil No
                                except:
                                    pass
                                #print "Home Win", odds
                            if t.find('div').getText().strip() == str % teams[1]:
                                odds = cls.get_odds(t)
                                games[i]['Sigurna pobeda 2']=odds[0]                #Away Win to Nil Yes
                                try: 
                                    games[i]['Sigurna pobeda 2 NE']=odds[1]        #Away Win to Nil No
                                except:
                                    pass
                                #print "Away Win", odds
                        except:
                            pass
                    break
            #Team To Score + Result
                if bet_type.getText().strip() == 'Team To Score + Result':
                    str = 'Both Teams To Score + '
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == str + teams[0] + ' To Win':
                                odds=cls.input_two_col_values(t, games[i], '1&GG', 'NE 1&GG')
                                #print "Both teams to score + Home Win", odds
                            if t.find('div').getText().strip() == str + teams[1] + ' To Win':
                                odds=cls.input_two_col_values(t, games[i], '2&GG', 'NE 2&GG')
                                #print "Both teams to score + Away Win", odds
                            if t.find('div').getText().strip() == str + 'Draw':
                                odds=cls.input_two_col_values(t, games[i], 'X&GG', 'NE X&GG')
                                #print "Both teams to score + Draw", odds
                            if t.find('div').getText().strip() == str + teams[0] + ' To Win Or Draw':
                                odds=cls.input_two_col_values(t, games[i], '1X & GG', 'NE 1X & GG')
                                #print "Both teams to score + Home Win Or Draw", odds
                            if t.find('div').getText().strip() == str + teams[0] + ' To Win Or ' + teams[1] + ' To Win':
                                odds=cls.input_two_col_values(t, games[i], '12 & GG', 'NE 12 & GG')
                                #print "Both teams to score + Home Win Or Away Win", odds
                            if t.find('div').getText().strip() == str + teams[1] + ' To Win Or Draw':
                                odds=cls.input_two_col_values(t, games[i], 'X2 & GG', 'NE X2 & GG')
                                #print "Both teams to score + Away Win Or Draw", odds
                        except:
                            pass
                    break
            #Score Draw
                if bet_type.getText().strip() == 'Score Draw':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            odds=cls.input_two_col_values(t, games[i], 'X & GG', 'NE X & GG')
                            #print "Score Draw", odds
                        except:
                            pass
                    break
            #1st Half + Full Time
                if bet_type.getText().strip() == '1st Half + Full Time':
                    try:
                        print "1st Half + Full Time"
                        odds=cls.get_odds(bet_type.parent.parent)
                        print "1st Half + Full Time", odds
                        games[i]['1-1']=odds[0]
                        games[i]['X-1']=odds[1]
                        games[i]['2-1']=odds[2]
                        games[i]['1-X']=odds[3]
                        games[i]['X-X']=odds[4]
                        games[i]['2-X']=odds[5]
                        games[i]['1-2']=odds[6]
                        games[i]['X-2']=odds[7]
                        games[i]['2-2']=odds[8]
                        print "1st Half + Full Time", odds
                    except:
                        pass
                    break
            #Full Time Result + Total Goals
                if bet_type.getText().strip() == 'Full Time Result + Total Goals':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == teams[0] + ' To Win + Total Under 2.5':
                                odds=cls.input_two_col_values(t, games[i], '1 & 0-2', 'NE 1 & 0-2')
                                #print "Home To Win + Total Under 2.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win + Total Under 3.5':
                                odds=cls.input_two_col_values(t, games[i], '1 & 0-3', 'NE 1 & 0-3')
                                #print "Home To Win + Total Under 3.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win + Total Over 2.5':
                                odds=cls.input_two_col_values(t, games[i], '1 & 3+', 'NE 1 & 3+')
                                #print "Home To Win + Total Over 2.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win + Total Over 3.5':
                                odds=cls.input_two_col_values(t, games[i], '1 & 4+', 'NE 1 & 4+')
                                #print "Home To Win + Total Over 3.5", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win + Total Under 2.5':
                                odds=cls.input_two_col_values(t, games[i], '2 & 0-2', 'NE 2 & 0-2')
                                #print "Away To Win + Total Under 2.5", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win + Total Under 3.5':
                                odds=cls.input_two_col_values(t, games[i], '2 & 0-3', 'NE 2 & 0-3')
                                #print "Away To Win + Total Under 3.5", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win + Total Over 2.5':
                                odds=cls.input_two_col_values(t, games[i], '2 & 3+', 'NE 2 & 3+')
                                #print "Away To Win + Total Over 2.5", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win + Total Over 3.5':
                                odds=cls.input_two_col_values(t, games[i], '2 & 4+', 'NE 2 & 4+')
                                #print "Away To Win + Total Over 3.5", odds
                            if t.find('div').getText().strip() == 'Draw + Total Under 2.5':
                                odds=cls.input_two_col_values(t, games[i], 'X & 0-2', 'NE X & 0-2')
                                #print "Draw + Total Under 2.5", odds
                            if t.find('div').getText().strip() == 'Draw + Total Under 3.5':
                                odds=cls.input_two_col_values(t, games[i], 'X & 0-3', 'NE X & 0-3')
                                #print "Draw + Total Under 3.5", odds
                            if t.find('div').getText().strip() == 'Draw + Total Over 2.5':
                                odds=cls.input_two_col_values(t, games[i], 'X & 3+', 'NE X & 3+')
                                #print "Draw + Total Over 2.5", odds
                            if t.find('div').getText().strip() == 'Draw + Total Over 3.5':
                                odds=cls.input_two_col_values(t, games[i], 'X & 4+', 'NE X & 4+')
                                #print "Draw + Total Over 3.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win Or Draw + Total Under 2.5':
                                odds=cls.input_two_col_values(t, games[i], '1X & 0-2', 'NE 1X & 0-2')
                                #print "Home To Win Or Draw + Total Under 2.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win Or Draw + Total Under 3.5':
                                odds=cls.input_two_col_values(t, games[i], '1X & 0-3', 'NE 1X & 0-3')
                                #print "Home To Win Or Draw + Total Under 3.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win Or Draw + Total Over 2.5':
                                odds=cls.input_two_col_values(t, games[i], '1X & 3+', 'NE 1X & 3+')
                                #print "Home To Win Or Draw Or Draw + Total Over 2.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win Or Draw + Total Over 3.5':
                                odds=cls.input_two_col_values(t, games[i], '1X & 4+', 'NE 1X & 4+')
                                #print "Home To Win Or Draw + Total Over 3.5", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win Or Draw + Total Under 2.5':
                                odds=cls.input_two_col_values(t, games[i], 'X2 & 0-2', 'NE X2 & 0-2')
                                #print "Away To Win Or Draw + Total Under 2.5", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win Or Draw + Total Under 3.5':
                                odds=cls.input_two_col_values(t, games[i], 'X2 & 0-3', 'NE X2 & 0-3')
                                #print "Away To Win Or Draw + Total Under 3.5", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win Or Draw + Total Over 2.5':
                                odds=cls.input_two_col_values(t, games[i], 'X2 & 3+', 'NE X2 & 3+')
                                #print "Away To Win Or Draw + Total Over 2.5", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win Or Draw + Total Over 3.5':
                                odds=cls.input_two_col_values(t, games[i], 'X2 & 4+', 'NE X2 & 4+')
                                #print "Away To Win Or Draw + Total Over 3.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win Or ' + teams[1] + ' To Win + Total Under 2.5':
                                odds=cls.input_two_col_values(t, games[i], '12 & 0-2', 'NE 12 & 0-2')
                                #print "Home Win Or Away Win + Total Under 2.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win Or ' + teams[1] + ' To Win + Total Under 3.5':
                                odds=cls.input_two_col_values(t, games[i], '12 & 0-3', 'NE 12 & 0-3')
                                #print "Home Win Or Away Win + Total Under 3.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win Or ' + teams[1] + ' To Win + Total Over 2.5':
                                odds=cls.input_two_col_values(t, games[i], '12 & 3+', 'NE 12 & 3+')
                                #print "Home Win Or Away Win + Total Over 2.5", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Win Or ' + teams[1] + ' To Win + Total Over 3.5':
                                odds=cls.input_two_col_values(t, games[i], '12 & 4+', 'NE 12 & 4+')
                                #print "Home Win Or Away Win + Total Over 3.5", odds
                        except:
                            pass
                    break
            #Halves Result
                if bet_type.getText().strip() == 'Halves Result':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == teams[0] + ' To Win Both Halves':
                                odds=cls.input_two_col_values(t, games[i], 'Dupla pobeda 1', 'Dupla pobeda 1 NE')
                                #print "Home To Win Both Halves", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win Both Halves':
                                odds=cls.input_two_col_values(t, games[i], 'Dupla pobeda 2', 'Dupla pobeda 2 NE')
                                #print "Home To Win Both Halves", odds
                        except:
                            pass
                    break
            #Substitute To Score
                if bet_type.getText().strip() == 'Substitute To Score':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            odds=cls.input_two_col_values(t, games[i], 'Izmena daje gol', 'Ne Izmena daje gol')
                            #print "Substitute To Score", odds
                        except:
                            pass
                    break
            #To Win Match With Handicap
                if bet_type.getText().strip() == 'To Win Match With Handicap':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(0)':
                                odds=cls.input_two_col_values(t, games[i], 'DNB 1', 'DNB 2')
                                #print "To Win Match With Handicap", odds
                        except:
                            pass
                    break
            #Total Goals
                if bet_type.getText().strip() == 'Total Goals':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(1.5)':
                                odds = cls.get_odds(t)
                                games[i]['0-1 goals']=odds[0]
                                games[i]['2+ goals']=odds[1]
                                #print "Totals 1.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(2.5)':
                                odds = cls.get_odds(t)
                                games[i]['0-2 goals']=odds[0]
                                games[i]['3+ goals']=odds[1]
                                #print "Totals 2.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(3.5)':
                                odds = cls.get_odds(t)
                                games[i]['0-3 goals']=odds[0]
                                games[i]['4+ goals']=odds[1]
                                #print "Totals 3.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(4.5)':
                                odds = cls.get_odds(t)
                                games[i]['0-4 goals']=odds[0]
                                games[i]['5+ goals']=odds[1]
                                #print "Totals 4.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(5.5)':
                                odds = cls.get_odds(t)
                                games[i]['0-5 goals']=odds[0]
                                games[i]['6+ goals']=odds[1]
                                #print "Totals 5.5", odds
                        except:
                            pass
                    break
            #Total Goals Home
                if bet_type.getText().strip() == 'Total Goals (%s)' % teams[0]:
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(0.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0 goals']=odds[0]
                                games[i]['Team 1 1+ goals']=odds[1]
                                #print "Totals 0.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(1.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0-1 goals']=odds[0]
                                games[i]['Team 1 2+ goals']=odds[1]
                                #print "Totals 1.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(2.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0-2 goals']=odds[0]
                                games[i]['Team 1 3+ goals']=odds[1]
                                #print "Totals 2.5", odds
                        except:
                            pass
                    break
            #Total Goals Away
                if bet_type.getText().strip() == 'Total Goals (%s)' % teams[1]:
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(0.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 2 0 goals']=odds[0]
                                games[i]['Team 2 1+ goals']=odds[1]
                                #print "Totals 0.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(1.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 2 0-1 goals']=odds[0]
                                games[i]['Team 2 2+ goals']=odds[1]
                                #print "Totals 1.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(2.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 2 0-2 goals']=odds[0]
                                games[i]['Team 2 3+ goals']=odds[1]
                                #print "Totals 2.5", odds
                        except:
                            pass
                    break
            #Total Goals Home
                if bet_type.getText().strip() == 'Total Goals (%s)' % teams[0]:
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(0.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0 goals']=odds[0]
                                games[i]['Team 1 1+ goals']=odds[1]
                                #print "Totals 0.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(1.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0-1 goals']=odds[0]
                                games[i]['Team 1 2+ goals']=odds[1]
                                #print "Totals 1.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(2.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0-2 goals']=odds[0]
                                games[i]['Team 1 3+ goals']=odds[1]
                                #print "Totals 2.5", odds
                        except:
                            pass
                    break
            #Total Goals Away
                if bet_type.getText().strip() == 'Total Goals (%s)' % teams[0]:
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(0.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0 goals']=odds[0]
                                games[i]['Team 1 1+ goals']=odds[1]
                                #print "Totals 0.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(1.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0-1 goals']=odds[0]
                                games[i]['Team 1 2+ goals']=odds[1]
                                #print "Totals 1.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(2.5)':
                                odds = cls.get_odds(t)
                                games[i]['Team 1 0-2 goals']=odds[0]
                                games[i]['Team 1 3+ goals']=odds[1]
                                #print "Totals 2.5", odds
                        except:
                            pass
                    break
            #Total Goals - 1st Half 
                if bet_type.getText().strip() == 'Total Goals  - 1st Half':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(0.5)':
                                odds = cls.get_odds(t)
                                games[i]['PP 0 goals']=odds[0]
                                games[i]['PP 1+ goals']=odds[1]
                                #print "Totals 0.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(1.5)':
                                odds = cls.get_odds(t)
                                games[i]['PP 0-1 goals']=odds[0]
                                games[i]['PP 2+ goals']=odds[1]
                                #print "Totals 1.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(2.5)':
                                odds = cls.get_odds(t)
                                games[i]['PP 0-2 goals']=odds[0]
                                games[i]['PP 3+ goals']=odds[1]
                                #print "Totals 2.5", odds
                        except:
                            pass
                    break
            #Total Goals - 2nd Half
                if bet_type.getText().strip() == 'Total Goals - 2nd Half':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(0.5)':
                                odds = cls.get_odds(t)
                                games[i]['DP 0 goals']=odds[0]
                                games[i]['DP 1+ goals']=odds[1]
                                #print "Totals 0.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(1.5)':
                                odds = cls.get_odds(t)
                                games[i]['DP 0-1 goals']=odds[0]
                                games[i]['DP 2+ goals']=odds[1]
                                #print "Totals 1.5", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(2.5)':
                                odds = cls.get_odds(t)
                                games[i]['DP 0-2 goals']=odds[0]
                                games[i]['DP 3+ goals']=odds[1]
                                #print "Totals 2.5", odds
                        except:
                            pass
                    break
            #Total Goals, Halves
                if bet_type.getText().strip() == 'Total Goals, Halves':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == 'Both Halves Under (1.5) Goals':
                                odds=cls.input_two_col_values(t, games[i], '0-1PP&0-1DP', 'NE 0-1PP&0-1DP')
                                print "Both Halves Under (1.5) Goals", odds
                            if t.find('div').getText().strip() == 'Both Halves Over (1.5) Goals':
                                odds=cls.input_two_col_values(t, games[i], '2+PP&2+DP', 'NE 2+PP&2+DP')
                                #print "Both Halves Over (1.5) Goals", odds
                        except:
                            pass
                    break
        #1st Half Result
                if bet_type.getText().strip() == '1st Half Result':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == teams[0] + ' To Win':
                                odds=cls.input_two_col_values(t, games[i], 'PP 1', '')
                                #print "Home To Win", odds
                            if t.find('div').getText().strip() == 'Draw':
                                odds=cls.input_two_col_values(t, games[i], 'PP X', '')
                                #print "Draw", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win':
                                odds=cls.input_two_col_values(t, games[i], 'PP 2', '')
                                #print "Away To Win", odds
                        except:
                            pass
                    break
        #2nd Half Result
                if bet_type.getText().strip() == '2nd Half Result':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == teams[0] + ' To Win':
                                odds=cls.input_two_col_values(t, games[i], 'DP 1', '')
                                #print "Home To Win", odds
                            if t.find('div').getText().strip() == 'Draw':
                                odds=cls.input_two_col_values(t, games[i], 'DP X', '')
                                #print "Draw", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Win':
                                odds=cls.input_two_col_values(t, games[i], 'DP 2', '')
                                #print "Away To Win", odds
                        except:
                            pass
                    break
            #Full Time Result + Total Goals
                if bet_type.getText().strip() == 'Full Time Result + Total Goals':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == '%s To Win + Total Over 2.5' % teams[0]:
                                odds = cls.get_odds(t)
                                games[i]['1 and 3+']=odds[0]                #home win and over 2.5
                                try:
                                    games[i]['1 and 3+ NE']=odds[1]        #home win and over 2.5 No
                                except:
                                    pass
                                #print "Home Win and over", odds
                            if t.find('div').getText().strip() == '%s To Win + Total Over 2.5' % teams[1]:
                                odds = cls.get_odds(t)
                                games[i]['2&3+']=odds[0]                #away win and over 2.5
                                try:
                                    games[i]['2&3+ NE']=odds[1]                #away win and over 2.5 No
                                except:
                                    pass
                                #print "Away Win and over", odds
                            if t.find('div').getText().strip() == 'Draw + Total Over 2.5':
                                odds = cls.get_odds(t)
                                games[i]['X and 3+']=odds[0]                #draw and over 2.5
                                try:
                                    games[i]['X and 3+ NE']=odds[1]        #Draw and over 2.5 No
                                except:
                                    pass
                                #print "Draw and over", odds
                        except:
                            pass
                    break
        #Goals
                if bet_type.getText().strip() == 'Goals':
                    tr=bet_type.parent.parent.findAll('tr')
                    for t in tr:
                        try:
                            if t.find('div').getText().strip() == teams[0] + ' To Score':
                                odds=cls.input_two_col_values(t, games[i], 'Team 1 1+ goals', 'Team 1 0 goals')
                                #print "Home To Score", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Score - 1st Half':
                                odds=cls.input_two_col_values(t, games[i], 'DOM PP 1+ goals', 'DOM PP 0 goals')
                                #print "Home To Score - 1st Half", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Score - 2nd Half':
                                odds=cls.input_two_col_values(t, games[i], 'DOM DP 1+ goals', 'DOM DP 0 goals')
                                #print "Home To Score - 2nd Half", odds
                            if t.find('div').getText().strip() == teams[0] + ' To Score In Both Halves':
                                odds=cls.input_two_col_values(t, games[i], 'DOM 1+&1+', 'NE DOM 1+&1+')
                                odds=cls.input_two_col_values(t, games[i], 'Team 1 PP1+&DP1+', 'NE Team 1 PP1+&DP1+')
                                #print "Home To Score In Both Halves", odds
                            if t.find('div').getText().strip() == 'Both Teams To Score':
                                odds=cls.input_two_col_values(t, games[i], 'GG', 'NG')
                                #print "Both Teams To Score", odds
                            if t.find('div').getText().strip() == 'Both Teams To Score In Both Halves':
                                odds=cls.input_two_col_values(t, games[i], 'PPGG&DPGG', 'NE PPGG&DPGG')
                                #print "Both Teams To Score In Both Halves", odds
                            if t.find('div').getText().strip() == 'Goals In Both Halves':
                                odds=cls.input_two_col_values(t, games[i], '1+&1+', 'NE 1+&1+')
                                odds=cls.input_two_col_values(t, games[i], '1+PP&1+DP', 'NE 1+PP&1+DP')
                                #print "Goals In Both Halves", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Score':
                                odds=cls.input_two_col_values(t, games[i], 'Team 2 1+ goals', 'Team 2 0 goals')
                                #print "Away To Score", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Score - 1st Half':
                                odds=cls.input_two_col_values(t, games[i], 'GOST PP 1+ goals', 'GOST PP 0 goals')
                                #print "Away To Score - 1st Half", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Score - 2nd Half':
                                odds=cls.input_two_col_values(t, games[i], 'GOST DP 1+ goals', 'GOST DP 0 goals')
                                #print "Away To Score - 2nd Half", odds
                            if t.find('div').getText().strip() == teams[1] + ' To Score In Both Halves':
                                odds=cls.input_two_col_values(t, games[i], 'GOST 1+&1+', 'NE GOST 1+&1+')
                                odds=cls.input_two_col_values(t, games[i], 'Team 2 PP1+&DP1+', 'NE Team 2 PP1+&DP1+')
                                #print "Away To Score In Both Halves", odds
                            if t.find('div').getText().strip() == 'Both Teams To Score - 1st Half':
                                odds=cls.input_two_col_values(t, games[i], 'PP GG', 'PP NG')
                                #print "Both Teams To Score  - 1st Half", odds
                            if t.find('div').getText().strip() == 'Both Teams To Score - 2nd Half':
                                odds=cls.input_two_col_values(t, games[i], 'DP GG', 'DP NG')
                                #print "Both Teams To Score - 2nd Half", odds
                            if t.find('div').getText().strip() == 'Both Teams To Score + Total Over 2.5':
                                odds=cls.input_two_col_values(t, games[i], 'GG 3+', 'NE GG 3+')
                                #print "Both Teams To Score + Total Over 2.5", odds
                            if t.find('div').getText().strip() == 'Both Teams To Score + Total Over 3.5':
                                odds=cls.input_two_col_values(t, games[i], 'GG 4+', 'NE GG 4+')
                                #print "Both Teams To Score + Total Over 2.5", odds
                            if t.find('div').getText().strip() == 'Both Teams To Score + Total Under 2.5':
                                odds=cls.input_two_col_values(t, games[i], 'GG 0-2', 'NE GG 0-2')
                                #print "Both Teams To Score + Total Under 2.5", odds
                            if t.find('div').getText().strip() == 'Both Teams To Score + Total Under 3.5':
                                odds=cls.input_two_col_values(t, games[i], 'GG 0-3', 'NE GG 0-3')
                                #print "Both Teams To Score + Total Under 3.5", odds
                            if t.find('div').getText().strip() == 'At Least One Team Not To Score + Total Under 2.5':
                                odds=cls.input_two_col_values(t, games[i], 'NG 0-2', 'NE NG 0-2')
                                #print "At Least One Team Not To Score + Total Under 2.5", odds
                            if t.find('div').getText().strip() == 'At Least One Team Not To Score + Total Under 3.5':
                                odds=cls.input_two_col_values(t, games[i], 'NG 0-3', 'NE NG 0-3')
                                #print "At Least One Team Not To Score + Total Under 3.5", odds
                        except:
                            pass
                    break
            #Number of Goals
                if bet_type.getText().strip() == 'Number of Goals':
                    td=bet_type.parent.parent.findAll('td')
                    for t in td:
                        try:
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(No goals)':
                                odds = cls.get_odds(t)
                                games[i]['Tr 0-0']=odds[0]
                                #print "No goals", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(1)':
                                odds = cls.get_odds(t)
                                games[i]['Tacno 1 goals']=odds[0]
                                #print "1 goal", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(2)':
                                odds = cls.get_odds(t)
                                games[i]['Tacno 2 goals']=odds[0]
                                #print "2 goal", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(3)':
                                odds = cls.get_odds(t)
                                games[i]['Tacno 3 goals']=odds[0]
                                #print "3 goal", odds
                            if t.find('div', {'class': 'coeff-handicap'}).getText().strip() == '(4)':
                                odds = cls.get_odds(t)
                                games[i]['Tacno 4 goals']=odds[0]
                                #print "4 goal", odds
                        except:
                            pass
                    break
           #1st Team to
                if bet_type.getText().strip() == '1st Team to':
                    td=bet_type.parent.parent.findAll('td')
                    for t in td:
                        try:
                            odds = cls.get_odds(t)
                            games[i]['Team 1 Prvi Daje Gol']=odds[0]
                            games[i]['Team 2 Prvi Daje Gol']=odds[1]
                            #print "1st Team to", odds
                        except:
                            pass
                    break
            time.sleep(.5)
            try:
                driver.find_element_by_xpath(cls.button_xp%id).click()
                #wait.until(EC.presence_of_element_located((By.XPATH, cls.button_xp%id))).click()
            except:
                print "lost in waiting"
            #driver.find_element_by_xpath(cls.button_xp%id).click()
            time.sleep(0.05)
        driver.close()
        return games
    @classmethod
    def input_two_col_values(cls, t, game, fieldname1, fieldname2):
        odds = cls.get_odds(t)
        game[fieldname1]=odds[0]
        try: 
            game[fieldname2]=odds[1]
        except:
            pass
        return odds
    @classmethod
    def clean_date(cls,match):
        date_str = match.find('td', {'class':'date'}).getText().strip() #date and time
        try:
            full_date=datetime.datetime.strptime(date_str, "%d %b %H:%M")
        except:
            today=format(datetime.datetime.now().date(), '%d %b')
            full_date = datetime.datetime.strptime(today+' '+date_str, "%d %b %H:%M")
        full_date+=datetime.timedelta(hours=1)
        date_s = '%d.%d' % (full_date.day, full_date.month)
        time_s = '%d:%d' % (full_date.hour, full_date.minute)
        if (full_date.minute<10):
            time_s+='0'
        if (full_date.hour<10):
            time_s='0'+time_s
        return [date_s, time_s]
    @classmethod
    def get_odds(cls,source):
        odds=source.findAll('span', {'class': 'selection-link normal '})
        for odd in odds:
            temp=odd.getText().strip().split('/')
            odds[odds.index(odd)]=round(float(int(temp[0])+int(temp[1]))/(int(temp[1])),2)
        return odds


s=MarathonbetScraper.scrape()
filename='marathon'
store_to_xlsx(s, filename + '.xlsx')

